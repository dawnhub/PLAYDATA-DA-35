## DA35-4th-MMPP-MMPP
## 프로세스 검토 결과 보고서

# 1. 프로젝트 진행 프로세스 설명

- 프로젝트 흐름도
  
    1. 데이터 수집 및 준비
    2. 모델 설계 및 개발
    3. 모델 학습 및 튜닝
    4. 모델 테스트 및 평가
    5. 결과 분석 및 보고서 작성
    6. 최종 발표 및 피드백 수집

- 단계별 목표 및 주요 활동

    1. 데이터 수집 및 준비
       - 목표: 모델 학습에 필요한 고품질 이미지 데이터셋 확보.
       - 주요 활동: 데이터 수집, 데이터 전처리, 데이터 증강.

    2. 모델 설계 및 개발
       - 목표: 프로필 사진 생성 모델의 구조 설계 및 초기 개발.
       - 주요 활동: 모델 아키텍처 설계, 필요한 기술 및 프레임워크 선정, 초기 모델 프로토타입 개발.


    3. 모델 학습 및 튜닝
       - 목표: 데이터셋을 이용한 모델 학습 및 최적화.
       - 주요 활동: 모델 학습, 하이퍼파라미터 튜닝, 성능 최적화.

    4. 모델 테스트 및 평가
       - 목표: 모델의 성능 평가 및 테스트.
       - 주요 활동: 모델 테스트, 성능 평가, 사용자 피드백 수집.

    5. 결과 분석 및 보고서 작성
       - 목표: 프로젝트 결과 분석 및 문서화.
       - 주요 활동: 결과 분석, 보고서 작성, PPT 작성.

    6. 최종 발표 및 피드백 수집
       - 목표: 프로젝트 최종 발표 및 피드백 수집.
       - 주요 활동: 발표 준비, 최종 발표, 피드백 수집 및 반영.
   
- 각 단계에 참여자
  
    - 고서영
      - 역할 및 책임: 모델 테스트, PPT 작성, 보고서 작성
    - 김기현
      - 역할 및 책임: 모델 테스트, PPT 작성, 보고서 작성
    - 이서희
      - 역할 및 책임: 팀장, 모델 설계
    - 이주호
      - 역할 및 책임: 데이터셋 조사

- 각 단계에서 사용된 도구 및 시스템
    - Google Colab : 리소스 확보
    - Diffuser PipeLine : 디퓨전 모델들의 파이프라인을 제공하는 패키지
    - Accelerate : 학습 속도 가속


# 2. 각 프로세스 결과 분석

- 성과
    - 주요 성과 지표(성과물, 시간)
    - 성과 평가

- 문제점
    - Overfitting 문제
        - 문제점
            - 특정 키워드나 스타일에 대한 이미지가 과도하게 생성되는 Overfitting 문제가 발생.
        - 영향
            - 특정 스타일의 이미지 생성 시 품질 저하.
            - 예를 들어, 해당 스타일이 건물 구조를 주로 생성하는 내용을 학습한 LoRA라면 얼굴의 일부를 건물 처럼 표현한다. 
        - 해결 방식
            - BPP LoRA : 안정적이고 고품질인 사람의 얼굴 데이터를 기반으로 생성한 LoRA를 만들고 베이스 모델에 결합시켜 아트 스타일 LoRA의 영향력을 일부 포기하고 안정성을 늘렸다.

    - 텍스트와 이미지 간의 불일치
        - 문제점
            - 프롬프트와 생성된 이미지 간의 불일치가 발생.
        - 영향
            - 사용자가 원하는 이미지와 실제 생성된 이미지 사이에 차이가 생겨 사용자 만족도 하락.
        - 해결 방식
          - Compel 패키지를 이용하여 프롬프트 내의 키워드별 가중치를 변경하여 해결할 것이다.
  
    - 사용자 스타일의 과도한 반영
        - 문제점
            - 사용자가 선택한 스타일이 지나치게 반영되어 예기치 않은 이미지가 생성되는 문제 발생.
        - 영향
            - 특정 스타일의 특성이 과도하게 반영되어 다양한 스타일을 유지하는데 어려움 발생.
        - 해결 방식
            - Prompt와 Negative Prompt를 적절히 조절하고 BPP LoRA의 scale을 늘려 해결.

- 개선점

    - 데이터 다양성 확보
        - 다양한 연령, 성별, 인종을 포함하는 고품질의 임지 데이터셋을 확보하여 프로필 타입의 이미지를 생성하도록 보장하는 BPP LoRA의 보편성과 적응력을 향상.
        - 더 많은 스타일과 주제를 포함하는 이미지 데이터셋을 구축.
  
    - Prompt 및 Parameter 조정
        - 이미지 품질을 안정화하기 위해 Prompt의 Parameter를 추가하고 조정.
     
    - 두 스타일 결합의 안정적 구현
        - LoRA를 직접 결합하면 성능이 떨어지는 것으로 확인. 
        - IP Adapter + 아트 스타일 LoRA를 통해 해결하였으나 생성되는 이미지가 불안정함
        - IP Adapter의 Scale Parameter를 적절히 설정하여 안정성 확보

    - 추론 속도 향상
        - 현재 사용중인 모델에서는 발생하는 torch.Compile 사용 문제의 원인을 파악하고 해결 방법을 모색.
       
    - Scheduler 업데이트
        - LCD Scheduler를 적용하여 모델의 추론 속도를 개선하도록 설정을 변경.

    - 모델 평가 문제
        - FID 및 각종 지표를 활용하거나 학습 속도 및 Loss 변화 과정을 통해 모델을 평가해야 했으나
        - 생성된 이미지의 직관적 품질로만 모델의 성능을 판단할 수 없었다.
        - 이는 모델 특성상 학습 시간 및 추론 시간이 길어서 발생하는 문제로, 다음 기회에는 충분한 시간을 두고 다양한 모델 및 하이퍼 파라미터간의 FID를 비교하여 평가할 것이다.  
